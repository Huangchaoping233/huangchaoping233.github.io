import{d as S,c as _,g as c,w as h,C as z,h as Z,b as $,e as C,i as r,t as I,j as F,u as R,k as q,l as K,F as T,a as J,m as Q,_ as N,n as M,r as f,E as x,q as U,s as W,v as X,x as E,p as k,y as Y,o as ee,z as te,A as oe,B as P,D as ne,G as se,H as ae,I as ce,J as re,K as le}from"./index-CfNFHChY.js";import{A as ie}from"./AttrList-CpAWT9zR.js";import{g as j,s as V}from"./dataUtils-BBW_Av8F.js";import{J as de,F as pe,e as me}from"./FileSaver.min-b1UHZip2.js";import{_ as ue}from"./Stage.vue_vue_type_style_index_0_lang-D_be-Ryi.js";const fe={class:"lc-comp-tree"},_e={class:"flex flex-row items-center space-x-2"},Ce=S({__name:"CompTree",props:{elements:{}},emits:["select","change"],setup(e,{emit:t}){const s=e,a=t,p={key:"id",label:"compCode",children:"elements"};function g(i){a("select",i)}function l(i,o,v,m){a("change",s.elements)}function b(i,o,v){return v=="inner"&&o.data.compType!==z.Layout?!1:!(o.data.compCode===Z.Page&&v!=="inner")}const D=(i,o)=>{K(s.elements,o.id)};return(i,o)=>{const v=$("el-icon"),m=$("el-tree");return C(),_("div",fe,[c(m,{data:i.elements,props:p,"expand-on-click-node":!1,"allow-drop":b,"highlight-current":"","default-expand-all":"",draggable:"",onNodeClick:g,onNodeDrop:l},{default:h(({node:n,data:u})=>[r("span",_e,[r("span",null,I(n.label),1),c(v,{class:"ml-2 hover:text-red-500",onClick:F(d=>D(n,u),["stop"])},{default:h(()=>[c(R(q))]),_:2},1032,["onClick"])])]),_:1},8,["data"])])}}}),ge={class:"lc-comp-list"},ve=["data-comp-code"],he=S({__name:"CompGroups",props:{groups:{}},setup(e){function t(s){s.dataTransfer.setData("compCode",s.target.dataset.compCode)}return(s,a)=>(C(),_("div",ge,[(C(!0),_(T,null,J(s.groups,(p,g)=>(C(),_(T,{key:g},[r("div",null,I(g),1),(C(!0),_(T,null,J(p,l=>(C(),_(T,{key:l.compCode},[l.hidden?Q("",!0):(C(),_("div",{key:0,class:"lc-comp",draggable:"true","data-comp-code":l.compCode,onDragstart:t},I(l.title||l.compCode),41,ve))],64))),128))],64))),128))]))}}),ye=N(he,[["__scopeId","data-v-91a3fc01"]]);function we(e,t){const s=new de;for(let a in t)s.file(a,t[a]);s.generateAsync({type:"blob"}).then(function(a){pe.saveAs(a,e+".zip")})}const be=e=>(U("data-v-2ff70223"),e=e(),W(),e),De={class:"lc-designer-header flex justify-between items-center px-6"},Ee=be(()=>r("div",null,"低代码-DEMO版",-1)),ke=S({__name:"EditorHeader",props:{elements:{}},emits:["reset"],setup(e,{emit:t}){const s=X(),a=t,p=e;M("mode",f("edit"));function g(){const o=j();a("reset",o),x("reset: "+JSON.stringify(o))}function l(){const o=V(p.elements);x("save: "+o)}function b(){const o=j();a("reset",o),x("init: "+JSON.stringify(o))}function D(){V(p.elements),s.push("/runtime")}async function i(){const o=await me(p.elements);we("vlowCode",{"test.vue":o})}return(o,v)=>{const m=$("el-button");return C(),_("div",De,[Ee,r("div",null,[c(m,{title:"页面进行初始化",onClick:b},{default:h(()=>[E("初始化")]),_:1}),c(m,{title:"重置为保存结果",onClick:g},{default:h(()=>[E("重置")]),_:1}),c(m,{onClick:l},{default:h(()=>[E("保存")]),_:1}),c(m,{title:"对导出当前编辑状态为vue页面",onClick:i},{default:h(()=>[E("页面导出")]),_:1}),c(m,{onClick:D},{default:h(()=>[E("保存并预览")]),_:1})])])}}}),xe=N(ke,[["__scopeId","data-v-2ff70223"]]);function O(e,t){for(;e;){if(e.classList.contains(t))return e;if(e.classList.contains("lc-stage"))return null;e=e.parentElement}return e}function Te(e){return O(e,"lc-layout")}function Se(e){return O(e,"lc-comp")}function $e(e){return e.getAttribute("lc-id")}function Ie(){let e=M("selectComp");e||(e=f({data:{}}),k("selectComp",e));const t=e;function s(a){t.value=a}return{selectedCompRef:t,setSelectedComp:s}}const Re={class:"lc-designer"},je={class:"lc-designer-header"},Ne={class:"lc-designer-body"},Ae={class:"lc-designer-body-item left"},Be={class:"lc-designer-body-item-item top"},Le={class:"lc-designer-body-item-item bottom"},Je={class:"lc-designer-body-item right"},Pe=S({__name:"Editor",setup(e){const t=f([{compCode:"LcPage",id:"null",compType:3,data:{}}]),s=f(null);k("allElements",t);const a=f([]);k("pageTreeData",a);const p=f("edit");k("mode",p);const g=f([{name:"hello",type:"function",content:`function hello(a,b){
        console.log('print world')
        return a+b
    }`},{name:"world",type:"function",content:`function world(){
        console.log('print world')
    }`}]);k("fnTreeData",g),Y(()=>{var n;a.value=re(((n=t.value[0])==null?void 0:n.data.variables)||{})}),f(le);function l(n){t.value=n}function b(n){var L;if(p.value!=="edit")return;const u=(L=n.dataTransfer)==null?void 0:L.getData("compCode");if(!u)return;let d;const A=Te(n.target);if(A!=null){const G=Se(A),H=$e(G);d=oe(t.value,H)}d==null&&(d=t.value[0]),d.elements==null&&(d.elements=[]);const y=P(d.compCode);if(y.childCompCodes&&!y.childCompCodes.includes(u))throw x.error(y.compCode+"只能添加"+y.childCompCodes.join(",")),new Error(y.compCode+"只能添加"+y.childCompCodes.join(","));const w=P(u);if(w.parentCompCodes&&!w.parentCompCodes.includes(d.compCode))throw x.error(w.compCode+"只能放入"+w.parentCompCodes.join(",")),new Error(w.compCode+"只能放入"+w.parentCompCodes.join(","));const B=ne(u);if(!B)throw new Error("未找到父节点");d.elements.push(B)}function D(n){console.log(n)}const i=f([{title:"标题",name:"title",component:"el-input"}]),{selectedCompRef:o,setSelectedComp:v}=Ie();function m(n){v(n),i.value=se(n.compCode)}return ee(()=>{const n=j();t.value=n}),(n,u)=>{const d=ae("fullscreen");return C(),_("div",Re,[r("div",je,[c(xe,{elements:t.value,onReset:l},null,8,["elements"])]),r("div",Ne,[r("div",Ae,[r("div",Be,[c(ye,{groups:R(ce)},null,8,["groups"])]),r("div",Le,[c(Ce,{ref_key:"compTreeRef",ref:s,elements:t.value,onSelect:m,onChange:D},null,8,["elements"])])]),r("div",{class:"lc-designer-body-item center lc-stage","drag-end":"",onDrop:b,onDragover:u[0]||(u[0]=F(()=>{},["prevent"]))},[c(ue)],32),r("div",Je,[te(c(ie,{attrs:i.value,data:R(o).data},null,8,["attrs","data"]),[[d]])])])])}}}),He=N(Pe,[["__scopeId","data-v-e5d310b5"]]);export{He as default};
